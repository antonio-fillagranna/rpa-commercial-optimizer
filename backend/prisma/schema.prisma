generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  id               String       @id @default(uuid()) @db.Uuid
  name             String
  industry         String?
  employee_count   Int?         @db.Integer
  revenue_estimate Decimal?     @db.Decimal(15, 2)
  website          String?
  created_at       DateTime     @default(now()) @db.Timestamp(3)
  
  // Relacionamento reverso: Uma empresa tem muitos leads
  leads            Lead[]

  @@map("companies")
}

model Lead {
  id               Int          @id @default(autoincrement())
  contact_name     String
  contact_email    String       @unique
  contact_role     String?
  budget_approved  Boolean      @default(false)
  authority_level  String?
  pain_points      String?
  urgency_timeline String?
  lead_score       Int          @default(0)
  status           String       @default("NEW")
  created_at       DateTime     @default(now()) @db.Timestamp(3)

  // Chave estrangeira para Company
  company_id       String?      @db.Uuid
  // Definição da relação:
  company          Company?     @relation(fields: [company_id], references: [id])
  
  // Relacionamento reverso: Um lead pode ter várias análises de IA
  ai_analyses      AiAnalysis[]

  @@map("leads")
}

model AiAnalysis {
  id                 String     @id @default(uuid()) @db.Uuid
  sentiment_analysis String?
  suggested_approach String?
  priority_score     Int?       @db.Integer
  processed_at       DateTime   @default(now()) @db.Timestamp(3)

  // Chave estrangeira para Lead (Atenção: mudei para Int para bater com o ID do Lead)
  lead_id            Int
  // Definição da relação:
  lead               Lead       @relation(fields: [lead_id], references: [id])

  @@map("ai_analysis")
}